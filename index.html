<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <title>GIF-tastic!</title>
</head>

<body>
    <h1>1980 was the best decade!</h1>

     <!-- Button -->
    <div id="gifButtonsView" class="container">
    </div>
    
    <!-- main Container -->
    <div class="container">
    <div class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
    <!-- gifs -->
    <div id="gifs-appear-here">
    </div>	
     </div>
    
    
    <!-- submit Form-->
    <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
     <form id="gifForm" role="form"> 
     </div>
     </div>
    
     
         <div class="form-group">
             <label for="topicInput"><h3>Add Your Favorite Decade</h3> </label>
             <input type="text" id="topicInput">
         </div>
         <input id="addGif" type="submit" value="Add Your Decade" class="btn btn-primary">
    
         <input id="removeGif" type="submit" value="Remove last Decade" class="btn btn-primary">	
     </form>


     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
     <script type="text/javascript">
    
    (document).ready(function (){
        // append git buttons

    var topic = ["80s movies", "80s horror", "80s comedy", "80s classic", "80s hair", "80s toys", "80s babes", "80s cars", "80s clothes", "Just 80s"]
    
    function displayGifButtons() {
        $("#gifs-appear-here").empty();
        for (var i = 0; i < topic.length; i++) {
            var gifButton = $("<button>");
            gifButton.addClass("topic-btn");
            gifButton.addClass("btn btn-primary");
            gifButton.attr("data-topic", topic[i].replace(/\s+/g, '+'));
            gifButton.text(topic[i]);
            $("#gifButtonsView").append(gifButton);
            $("topic-btn").on("click", function (e){
                displayGifs($(this).attr("data-topic"));
            });
        }
    // add new buttons
    function addNewButton() {
        $("#addGif").on("click", function () {
            var topic = $("#topicInput").val().trim();
            if (topic == "") {
                return false;
            }
            topic.push(topic);

            displayGifButtons();
            return false;
        });    
        }
    // Display Gifs
    function displayGifs() {
        var movie = $(this).attr("data-name");
        var movie = $(this).attr("data-topic");
        var queryURL = "https://api.giphy.com/v1/gifs/search?&api_key=8E2MeC0HBzb42wPA9MMb4GhvuIr4Lcw1&limit=10&offset=0&rating=PG-13&lang=en&tag=" + movie;
        $.ajax({
        url: queryURL,
        method: 'GET'
        })

        .then(function (response) {
            $("#gifs-appear-here").empty();
            //show results of gifs
            var results = response.data;
            if (results == "") {
                alert("NO GIF FOR YOU!!!");
            }
            for (var i = 0; i < results.length; i++) {
            //put gifs in a div
            var gifDiv = $("<div1>");
            //pull rating of gif
            var gifRating = $("<p>").text("Rating " + results[i].rating);
            gifDiv.append(gifRating);

            //pull gif
            var gifImage = $("<img>");
            gifImage.attr("src", results[i].images.fixed_height_small_still.url);
            //paused images
            gifImage.attr("data-still", results[i].images.fixed_height_small_still.url);
            //animated images
            gifImage.attr("data-animate", results[i].images.fixed_height_small.url);
            //how images come in, already paused
            gifImage.attr("data-state", "still");
            gifImage.addClass("image");
            gifDiv.append(gifImage);
            //add new div to existing divs
            $("#gifsView").prepend(gifDiv);
                
        }});

        //event listeners
        $(document).on("click", ".movie", displayGifs);
         $(document).on("click", ".image", function () {
            var state = $(this).attr('data-state');
            if (state == 'still') {
                $(this).attr('src', $(this).data('animate'));
                $(this).attr('data-state','animate');
            } else {
                $(this).attr('src', $(this).data('still'));
                $(this).attr('data-state', 'still');
                }

         

        }); 

    };
    </script>

   </body>

</html>